dataSource:
  name: BidContextual
  rootPath: /Users/sven.zhang/Documents/local_test
  prefix: /source=contextualwithbid/raw/date={dateStr}/hour={hourInt}
  format: parquet

aggLevels:
  - level: AdvertiserId
    saltSize: 5
    initAggGrains: [ hour ]
    initWritePartitions: 1
    rollupWritePartitions: 1
  - level: CampaignId
    saltSize: 5
    initAggGrains: [ hour ]
    initWritePartitions: 1
    rollupWritePartitions: 1
  - level: TDID
    saltSize: -1
    initAggGrains: [ hour, day ]
    initWritePartitions: 1
    rollupWritePartitions: 1

initAggConfig:
  outputRootPath: /Users/sven.zhang/Documents/local_test
  outputPrefix: /source=contextualwithbid/index={indexPartition}/job={grain}InitialAggJob
  dataIntegrity: AT_LEAST_ONE

rollupAggConfig:
  outputRootPath: /Users/sven.zhang/Documents/local_test
  outputPrefix: /source=contextualwithbid/index={indexPartition}/job=RollupAggJob/date={dateStr}
  windowGrain: day

aggregations:
  - field: ContextualEmbeddingCategories
    dataType: array_int
    aggWindows: [ 1, 3, 7 ]
    aggFunc: [ Frequency ]
  - field: ContextualProbabilityScores
    dataType: vector
    aggWindows: [ 1, 3, 7 ]
    aggFunc: [ Mean, Max ]